{% extends 'base.html' %}

{% block body %}
    <div style="margin-top: 100px;">
        {% for user in users %}
            {% include './partials/user_settings_partial.html' with user=user %}
        {% endfor %}
    </div>

    <script>
        // Toggle card expansion function
        function toggleCardExpansion(e) {
            // Get the hidden divs on the given card
            var card = e.parentNode;
            var cardTitle = e.querySelector('#card-title');
            var toggleIcon = card.querySelector('#toggle-icon');
            var profileDiv = card.querySelector('#profile-div');
            var vacationPolicyDiv = card.querySelector('#vacation-policy-div');
            var updateButtonDiv = card.querySelector('#update-button-div');

            // Toggle the visibility of hidden divs
            if (toggleIcon.innerHTML == 'expand_more') {
                cardTitle.innerHTML = 'Edit {{ user.first_name }}\'s Settings';
                toggleIcon.innerHTML = 'expand_less';
                profileDiv.style.display = 'block';
                vacationPolicyDiv.style.display = 'block';
                updateButtonDiv.style.display = 'block';
            } else {
                cardTitle.innerHTML = '{{ user.first_name }} {{ user.last_name }}';
                toggleIcon.innerHTML = 'expand_more';
                profileDiv.style.display = 'none';
                vacationPolicyDiv.style.display = 'none';
                updateButtonDiv.style.display = 'none';
            }

            // Toggle read only attribute of editable fields
            var annualAccrualDays = card.querySelector('#annual-accrual-days');
            var maxAllowableAccrualDays = card.querySelector('#max-allowable-accrual-days');
            annualAccrualDays.readOnly = !annualAccrualDays.readOnly;
            maxAllowableAccrualDays.readOnly = !maxAllowableAccrualDays.readOnly;
        };
    </script>
{% endblock %}
